public static String convertFeedtypeErrorReportToHtmlTable(Map<String, Map<String, String>> data) {
        if (data == null || data.isEmpty()) {
            return "<p>No Feedtype Error Report data to display.</p>";
        }

        StringBuilder htmlTable = new StringBuilder("<table>\n");

        htmlTable.append("  <thead>\n");
        htmlTable.append("    <tr style=\"background-color: #ADD8E6; font-size: 14px;\">\n");
        htmlTable.append("      <th style=\"text-align: center;\">Feed Type Name</th>\n");
        htmlTable.append("      <th style=\"text-align: center;\">Count</th>\n");
        htmlTable.append("      <th style=\"text-align: center;\">Percentage</th>\n");
        htmlTable.append("    </tr>\n");
        htmlTable.append("  </thead>\n");

        htmlTable.append("  <tbody>\n");
        for (Map.Entry<String, Map<String, String>> entry : data.entrySet()) {
            String feedTypeName = entry.getKey();
            Map<String, String> errorData = entry.getValue();
            String count = errorData.get("count");
            String percentage = errorData.get("percentage");

            htmlTable.append("    <tr style=\"text-align: center;\">\n"); 
            htmlTable.append("      <td>").append(escapeHtml(feedTypeName)).append("</td>\n");
            htmlTable.append("      <td>").append(escapeHtml(count)).append("</td>\n");
            htmlTable.append("      <td>").append(escapeHtml(percentage)).append("</td>\n"); // 直接使用已格式化的 percentage
            htmlTable.append("    </tr>\n");
        }
        htmlTable.append("  </tbody>\n");

        htmlTable.append("</table>\n");

        htmlTable.append("<style>\n");
        htmlTable.append("  table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }\n");
        htmlTable.append("  th, td { border: 1px solid black; padding: 8px; font-size: 14px; color: black; }\n");
        htmlTable.append("</style>\n");

        return htmlTable.toString();
    }
public static String convertFailedServicePerFeedTypeToHtmlTable(Map<String, LinkedHashMap<String, String>> data) {
        if (data == null || data.isEmpty()) {
            return "<p>No Failed Service per Feed Type data to display.</p>";
        }

        StringBuilder htmlTable = new StringBuilder("<table>\n");

        // 创建表头
        htmlTable.append("  <thead>\n");
        htmlTable.append("    <tr style=\"background-color: #ADD8E6; font-size: 14px;\">\n");
        htmlTable.append("      <th style=\"text-align: center;\">Feed type name</th>\n");
        htmlTable.append("      <th style=\"text-align: center;\">Failed Service List</th>\n");
        htmlTable.append("    </tr>\n");
        htmlTable.append("  </thead>\n");

        // 创建表体
        htmlTable.append("  <tbody>\n");
        for (Map.Entry<String, LinkedHashMap<String, String>> entry : data.entrySet()) {
            String feedTypeName = entry.getKey();
            LinkedHashMap<String, String> failedServices = entry.getValue();

            htmlTable.append("    <tr>\n");
            htmlTable.append("      <td style=\"text-align: center;\">").append(escapeHtml(feedTypeName)).append("</td>\n");
            htmlTable.append("      <td style=\"text-align: left;\">\n");

            StringBuilder failedServiceListHtml = new StringBuilder();
            for (Map.Entry<String, String> serviceEntry : failedServices.entrySet()) {
                String serviceName = serviceEntry.getKey();
                String errorCount = serviceEntry.getValue();
                failedServiceListHtml.append(escapeHtml(serviceName)).append(": ").append(escapeHtml(errorCount)).append("<br/>\n");
            }
            htmlTable.append(failedServiceListHtml).append("      </td>\n");
            htmlTable.append("    </tr>\n");
        }
        htmlTable.append("  </tbody>\n");

        htmlTable.append("</table>\n");

        // 添加一些基本的 CSS 样式（可选，但内联样式优先级更高）
        htmlTable.append("<style>\n");
        htmlTable.append("  table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }\n");
        htmlTable.append("  th, td { border: 1px solid black; padding: 8px; font-size: 14px; color: black; }\n");
        htmlTable.append("</style>\n");

        return htmlTable.toString();
    }

    private static String escapeHtml(String text) {
        if (text == null) {
            return "";
        }
        return text.replace("<", "&lt;")
                   .replace(">", "&gt;")
                   .replace("\"", "&quot;")
                   .replace("&", "&amp;");
    }

